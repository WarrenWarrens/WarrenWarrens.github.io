<!DOCTYPE html>
<html class="HTML" lang="en">
<head>
    <meta charset="UTF-8">
    <title>Yokel Final</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"></script>

    <style>
        /* --- 1. GLOBAL RESET (Fixes the width mismatch) --- */
        * {
            box-sizing: border-box;
        }

        /* --- CORE LAYOUT --- */
        .HTML, .BodyOverLord {
            height: 100%;
            margin: 0;
            padding: 0;
            font-family: sans-serif;
        }

        .Main {
            height: calc(100vh - 20px);
            width: calc(100vw - 20px);
            margin: 10px;
            background: orangered;
            display: flex;
        }

        /* --- COLUMNS --- */
        #Left {
            background-color: #003cff;
            width: calc(100% - 100px);
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        #Right {
            background-color: #4caf50;
            width: 100px;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        /* --- HEADERS --- */
        .DivLine {
            width: 100%;
            height: 25px;
            background-color: #e10202;
            color: white;
            font-size: 12px;
            display: flex;
            align-items: center;
            padding-left: 5px;
            flex: 0 0 auto;
        }

        /* --- MAIN SECTIONS (The Swappable Pages) --- */
        .SectionMain {
            display: none;        /* Hidden by default */
            flex: 1;              /* Fill remaining space */
            overflow-y: auto;     /* Scrollable */
            flex-direction: column;
            padding: 10px;
            background-color: pink;
        }

        /* Helper to center content inside a section */
        .DivCentreFull {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100px;
            border: 1px dashed #555;
            margin: 10px 0;
        }

        .Pre {
            background: #fff;
            padding: 10px;
            overflow-x: auto;
            border-radius: 4px;
        }

        /* --- GUIDES (Horizontal Draggables) --- */
        #DynamicGuideContainer {
            width: 100%;
            min-height: 0;
            background-color: #222;
        }

        .HiddenGuide {
            display: none;
            width: 100%;
            height: 50px;
            color: white;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .DivGuide {
            width: 100%;
            height: 50px;
            background-color: teal;
            display: flex;
            flex: 0 0 auto;
        }

        #Settings, #GuideLeft {
            display: flex;
            flex-direction: row;
            overflow-x: auto;
            overflow-y: hidden;
            scroll-snap-type: x mandatory;
            align-items: center;
            padding-left: 10px;
            height: 100%;
        }
        #GuideLeft { width: 125px; }

        #GuideRight {
            width: calc(100% - 125px);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            background-color: #555555;
        }

        /* --- NAVIGATION / AD BAR (Vertical Draggable) --- */
        #Ad {
            flex: 1;
            background-color: #FF9F55;
            overflow-y: auto;
            overflow-x: hidden;
            scroll-snap-type: y mandatory;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-top: 10px;

            /* SCROLLBAR STYLING */
            scrollbar-width: thin;
            scrollbar-color: #d37c3b #FF9F55;
        }

        /* Chrome/Safari Scrollbar */
        #Ad::-webkit-scrollbar { width: 12px; }
        #Ad::-webkit-scrollbar-track { background: #FF9F55; }
        #Ad::-webkit-scrollbar-thumb {
            background-color: #d37c3b;
            border-radius: 10px;
            border: 3px solid #FF9F55;
        }

        #Orb {
            width: 100px;
            height: 100px;
            background-color: #121212;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            flex: 0 0 auto;
        }

        /* --- DRAGGABLE BUTTONS --- */
        .DivSetting, .DivAd {
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            cursor: pointer;
            user-select: none;
            scroll-snap-align: start;
            flex: 0 0 auto;
            border-radius: 4px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .DivSetting {
            width: 25px;
            height: 25px;
            margin-right: 10px;
            background-color: #fff;
            color: #333;
            border: 2px solid #333;
        }

        /* Highlight Class */
        .active-btn {
            background-color: #e10202 !important;
            color: white !important;
            border-color: white !important;
        }

        .DivAd {
            width: 50px;
            height: 50px;
            margin-bottom: 10px;
            background-color: #2196F3;
            color: white;
        }

        /* Sortable Helpers */
        .SortGhost { opacity: 0.4; background-color: #ddd; border: 2px dashed #999; }
        .SortDrag { cursor: grabbing; }

    </style>
</head>

<body class="BodyOverLord">

<main class="Main">

    <div id="Left">
        <div class="DivLine">METAL YOKEL</div>

        <section class="SectionMain" id="SectionMain1">
            <div class ="DivCentre">
                <pre class="Pre">
░▒▓██████████████▓▒░░▒▓████████▓▒░▒▓████████▓▒░
░▒▓█▓▒░░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░         ░▒▓█▓▒░
░▒▓█▓▒░░▒▓█▓▒░░▒▓█▓▒░▒▓██████▓▒░    ░▒▓█▓▒░
░▒▓█▓▒░░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░         ░▒▓█▓▒░
░▒▓█▓▒░░▒▓█▓▒░░▒▓█▓▒░▒▓████████▓▒░  ░▒▓█▓▒░
                </pre>
            </div>
            <p><strong>Welcome to Metal Yokel</strong><br>
                This serves as my public exhibit. This section (1) is the fallback; it will appear if you try to close everything else.</p>
        </section>

        <section class="SectionMain" id="SectionMain2" style="background-color: #ffd1dc;">
            <h2>APP SECTION</h2>
            <div class="DivCentreFull">App 1</div>
            <div class="DivCentreFull">App 2</div>
        </section>

        <section class="SectionMain" id="SectionMain3" style="background-color: #d1ffdc;">
            <h2>CHAT SECTION</h2>
            <div class="DivCentreFull">Chat logs...</div>
        </section>

        <div id="DynamicGuideContainer">
            <div id="HiddenGuide1" class="HiddenGuide" style="background-color: gold; color: black;">
                Setting Menu
            </div>
            <div id="HiddenGuide2" class="HiddenGuide" style="background-color: crimson;">
                App Options
            </div>
            <div id="HiddenGuide3" class="HiddenGuide" style="background-color: indigo;">
                Terminal Input
            </div>
        </div>

        <div class="DivGuide">
            <div id="GuideLeft">
                <div class="DivSetting" onclick="toggleGuide('1', this)">1</div>
                <div class="DivSetting" onclick="toggleGuide('2', this)">2</div>
                <div class="DivSetting" onclick="toggleGuide('3', this)">3</div>
            </div>

            <div id="GuideRight">
                ORB TALKIN
            </div>
        </div>
    </div>

    <div id="Right">
        <div class="DivLine">LINE</div>

        <div id="Ad">
            <div id="Btn1" class="DivAd" onclick="toggleSection('1', this)">1</div>
            <div class="DivAd" onclick="toggleSection('2', this)">2</div>
            <div class="DivAd" onclick="toggleSection('3', this)">3</div>

            <div class="DivAd" onclick="toggleSection('4', this)">4</div>
            <div class="DivAd" onclick="toggleSection('5', this)">5</div>
        </div>

        <div id="Orb">ORB</div>
    </div>
</main>

<script>
    /* ==============================
       GUIDE LOGIC (Toggle Only)
       ============================== */
    function toggleGuide(idSuffix, btnElement) {
        var targetId = 'HiddenGuide' + idSuffix;
        var targetDiv = document.getElementById(targetId);
        var isCurrentlyVisible = targetDiv.style.display === 'flex';

        // Hide all guides
        document.querySelectorAll('.HiddenGuide').forEach(div => div.style.display = 'none');
        document.querySelectorAll('#GuideLeft .DivSetting').forEach(btn => btn.classList.remove('active-btn'));

        // If it wasn't visible, show it. If it was, we just leave it hidden (toggle off).
        if (!isCurrentlyVisible) {
            targetDiv.style.display = 'flex';
            btnElement.classList.add('active-btn');
        }
    }

    /* ==============================
       SECTION LOGIC (Fallback to 1)
       ============================== */
    function toggleSection(idSuffix, btnElement) {
        var targetId = 'SectionMain' + idSuffix;
        var targetSection = document.getElementById(targetId);

        // 1. Is the clicked section currently open?
        // We check if it is explicitly set to flex
        var isAlreadyOpen = (targetSection && targetSection.style.display === 'flex');

        // 2. Hide ALL sections (clean slate)
        document.querySelectorAll('.SectionMain').forEach(function(sec) {
            sec.style.display = 'none';
        });

        // 3. Remove highlight from ALL buttons
        document.querySelectorAll('#Ad .DivAd').forEach(function(btn) {
            btn.classList.remove('active-btn');
        });

        // 4. LOGIC TREE
        if (!isAlreadyOpen) {
            // CASE A: Opening a new section (Normal behavior)
            if (targetSection) {
                targetSection.style.display = 'flex';
                btnElement.classList.add('active-btn');
            } else {
                // If section doesn't exist (e.g., button 4, 5), default to home
                openHome();
            }
        } else {
            // CASE B: User clicked the button of the OPEN section (Trying to close it)
            // Since we just hid everything in step 2, nothing is visible now.
            // REQUIREMENT: "SectionMain1 be visible if nothing else is"
            openHome();
        }
    }

    // Helper to force open Section 1
    function openHome() {
        var homeSec = document.getElementById('SectionMain1');
        var homeBtn = document.getElementById('Btn1');

        if(homeSec) homeSec.style.display = 'flex';
        if(homeBtn) homeBtn.classList.add('active-btn');
    }

    /* ==============================
       INITIALIZATION
       ============================== */

    // 1. Setup Sortables
    function initSortable(id, direction) {
        var el = document.getElementById(id);
        if (!el) return;
        Sortable.create(el, {
            animation: 150,
            direction: direction,
            ghostClass: 'SortGhost',
            dragClass: 'SortDrag',
            scroll: true,
            scrollSensitivity: 30,
            scrollSpeed: 10,
        });
    }

    initSortable('HiddenGuide1', 'horizontal');
    initSortable('HiddenGuide2', 'horizontal');
    initSortable('GuideLeft', 'horizontal');
    initSortable('Ad', 'vertical');

    // 2. Start the page by forcing Section 1 open
    openHome();

</script>
</body>
</html>